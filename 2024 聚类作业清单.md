# 2024 聚类作业

一共有 4 道聚类题目，难度递增

需要聚类的数据我们将会以 `.npy`的格式打包给大家，附件中有一份 demo 代码，请查看本目录下的`load_data_example.py`

```python
import os
import numpy as np
import matplotlib as mpl

mpl.use('Agg')
import matplotlib.pyplot as plt

data = np.load(os.path.join('data', 'data_example.npy'))
label = np.load(os.path.join('data', 'label_example.npy'))
print(data.shape, label.shape)

plt.scatter(data[:, 0], data[:, 1], c=label)
plt.axis('equal')
plt.savefig('data_example.jpg')

print([(data[i], label[i]) for i in range(10)])
```

## 题目举例：

给定**M** 个`Size`为`（S）`的向量，将它们分为**N**类, 
N 由题目给定或自己尝试决定（对于4道题目要求不同）

```python
def cluster_task_2(sample):
    """
    载入位于data/data2.npy的数据。
    对于data2.npy中给定的1000个Shape为(2)的向量,将它们聚类成N类,类别ID 从0至N-1。

    Args:
        sample (np.ndarray): Shape: (1000, 2)

    Returns:
        label (np.ndarray): Shape: (1000, ), 请保证label与sample的index一致
    """
    label = np.zeros((sample.shape[0]))

    # your code here

    return label
```

# 题目要求:

补全`func.py`文件，里面一共有四个函数的原型。请填空。
```python
import numpy as np
import os

def cluster_task_1(sample):
    ...

def cluster_task_2(sample):
    ...

def cluster_task_3(sample):
    ...

def cluster_task_4(sample):
    ...

def main():
    data1 = np.load(os.path.join("data", "data1.npy"))
    data2 = np.load(os.path.join("data", "data2.npy"))
    data3 = np.load(os.path.join("data", "data3.npy"))
    data4 = np.load(os.path.join("data", "data4.npy"))

    label1 = cluster_task_1(data1)
    label2 = cluster_task_2(data2)
    label3 = cluster_task_3(data3)
    label4 = cluster_task_4(data4)

    np.save(os.path.join("output", "label1.npy"), label1)
    np.save(os.path.join("output", "label2.npy"), label2)
    np.save(os.path.join("output", "label3.npy"), label3)
    np.save(os.path.join("output", "label4.npy"), label4)


if __name__ == '__main__':
    main()
```
完成后请运行

```
python func.py
```

此代码会将你的结果保存至`output`文件夹内， 
最后，你需要提交该output文件夹， 代码， 以及一份实验报告。
将这三个文件（文件夹）压缩成一个zip。按照`学号+姓名.zip`命名，并在截止时间之前提交到canvas


**请注意：**
1. 每个函数返回值:`label`一定是一个shape为`(M, )`的 `numpy.ndarray`对象；
2. **请保证** `label`与`sample`的index一致， 即第`i`个sample对应的分类结果在label中也是第`i`个；
3. output文件夹一共有四个结果：`label1.npy ～ label4.npy`，对应四道题；
4. 如果不按照以上要求保存，将无法通过我们的测试脚本，这将会影响你的成绩。
5. 一定要提交能够完整运行并 得到 `label1.npy ～ label4.npy` 代码，这将会影响你的成绩。
6. 一定要提交一份`实验报告.pdf`; 实验报告中需要写下你每道题的实验设计，参数选择，结果与分析，以及可以写出一些相关思考。这也将作为最后的打分/选拔标准。

关于**调包**的问题：  
关于矩阵运算，我们**只允许**使用numpy.ndarray 或 pytorch.Tensor 提供的函数。

我们**禁止**在函数中直接使用 scipy, cluster, scikit-learn, sklearn， pykeops 等包中提供的聚类、降维算法。
